\chapter{Spherical geometry}
\label{chap:sphere}
\addtocontents{toc}{\protect\begin{quote}}

Spherical geometry is the geometry 
of the surface of the unit sphere.
This type of geometry has practical  applications in cartography, navigation  and astronomy.

The spherical geometry is a close relative of Euclidean and hyperbolic geometries.
Most of theorems of hyperbolic geometry have spherical analogs,
but spherical geometry is easier to visualize. 

We discuss few theorems in spherical geometry;
the proofs are not completely rigorous.

\section*{Spheres in the space}
\addtocontents{toc}{Spheres in the space.}

Recall that Euclidean space is the set $\mathbb{R}^3$ of all triples $(x,y,z)$ of real numbers
such that the distance between a pair of points
$A=(x_A,y_A,z_A)$ and $B=(x_B,y_B,z_B)$
is defined by the following formula
$$AB
\df
\sqrt{(x_A-x_B)^2+(y_A-y_B)^2+(z_A-z_B)^2}.$$

The planes in the space defined as the set of solutions of equation 
$$a\cdot x+b\cdot y+c\cdot z+d=0$$ 
for real numbers $a$, $b$, $c$ and $d$ such that at least one of the numbers $a$, $b$ or $c$ is not zero.
Equivalently plane can be defined as a subset of Euclidean space which is isometric to Euclidean plane.

Sphere in the space is the direct analog of circle in the plane.
Formally, \index{sphere}\emph{sphere} with center $O$ and radius $r$ is the set of points in the space which lie on the distance $r$ from $O$.

Let $A$ and $B$ be two points on the unit sphere centered at $O$.
The \index{spherical distance}\emph{spherical distance} from $A$ to $B$
(briefly $AB_s$)
 is defined as  $|\measuredangle AOB|$. 

In the spherical geometry, the role of lines play the \index{great circle}\emph{great circles};
that is, the intersection of the sphere with a plane passing thru $O$.


Note that the great circles do not form lines in the sense of Definition~\ref{def:line}.
Also any two distinct great circles intersect at two antipodal points.
In particular, the sphere does not satisfy the axioms of absolute plane.







\section*{Pythagorean theorem}
\addtocontents{toc}{Pythagorean theorem.}

Here is an analog of Pythagorean Theorems (\ref{thm:pyth} and \ref{thm:pyth-h}) in spherical geometry.

\begin{thm}{Theorem}\label{thm:s-pyth}
Let $\triangle_sABC$ be a spherical triangle with right angle at $C$.
Set $a=BC_s$, $b=CA_s$ and $c=AB_s$.
Then
$$\cos c=\cos a\cdot\cos b.$$

\end{thm}

In the proof we will use the notion of scalar product which we are about to discuss.

Let $A$ and $B$ be two points in Euclidean space.
Denote by $v_A\z=(x_A,y_A,z_A)$ and $v_B=(x_B,y_B,z_B)$ the position vectors of $A$ and $B$ correspondingly.
The scalar product of two vectors $v_A$ and $v_B$ in $\mathbb{R}^3$
is defined as 
$$\langle v_A,v_B\rangle
\df
x_A\cdot x_B+y_A\cdot y_B+z_A\cdot z_B.\eqlbl{eq:scal-angle}$$

Assume both vectors $v_A$ and $v_B$ are nonzero
and $\phi$ is the angle measure between these two vectors.
In this case the scalar product can be expressed the following way:
$$\langle v_A,v_B\rangle=|v_A|\cdot|v_B|\cdot\cos\phi,$$
where 
\begin{align*}
|v_A|&=\sqrt{x_A^2+y_A^2+z_A^2},
&
|v_B|&=\sqrt{x_B^2+y_B^2+z_B^2}.
\end{align*}

\begin{wrapfigure}[8]{o}{33mm}
\begin{lpic}[t(-5mm),b(-0mm),r(0mm),l(0mm)]{pics/s-right-trig-new(1)}
\lbl[t]{15,13;$O$}
\lbl[rbw]{14,28;$C$}
\lbl[rb]{9,20;$B$}
\lbl[t]{20,21;$A$}
\lbl[t]{32,12;$x$}
\lbl[rb]{2,5;$y$}
\lbl[lb]{16,32;$z$}
\end{lpic}
\end{wrapfigure}

Now, assume the points $A$ and $B$ 
lie on the unit sphere in $\mathbb{R}^3$ centered at the origin.
In this case $|v_A|=|v_B|=1$.
By \ref{eq:scal-angle} we get
$$\cos AB_s=\langle v_A,v_B\rangle.
\eqlbl{eq:scalar-s-dist}$$

\parit{Proof.}
Since the angle at $C$ is right,
we can choose coordinates in $\mathbb{R}^3$ so that 
$v_C\z=(0,0,1)$, $v_A$ lies in $xz$-plane, so $v_A\z=(x_A,0,z_A)$
and $v_B$ lies in $yz$-plane, so $v_B=(0,y_B,z_B)$.

Applying, \ref{eq:scalar-s-dist},
we get
\begin{align*}
z_A&=\langle v_C,v_A\rangle
=\cos b,
\\
z_B&=\langle v_C,v_B\rangle
=\cos a.
\end{align*}

Applying, \ref{eq:scalar-s-dist} again, we get
\begin{align*}
\cos c &=\langle v_A,v_B\rangle=
\\
&=x_A\cdot 0+0\cdot y_B+z_A\cdot z_B=
\\
&=\cos b\cdot\cos a.
\end{align*}
\qedsf

\begin{thm}{Exercise}\label{ex:2(pi/4)=pi/3}
Show that if $\triangle_sABC$ be a spherical triangle with right angle at $C$
and $AC_s=BC_s=\tfrac\pi4$ then $AB_s=\tfrac\pi3$.

Try to find two solutions, with and without using the spherical Pythagorean theorem.
\end{thm}

\section*{Inversion of the space}
\addtocontents{toc}{Inversion of the space.}

The inversion in the sphere defined the same way as we define inversion in the circle.

Formally, let $\Sigma$ be the sphere with center $O$ and radius $r$.
The \index{inversion!inversion in a sphere}\emph{inversion} in $\Sigma$ of a point $P$ is the point $P'\in[OP)$ such that
$$OP\cdot OP'=r^2.$$
In this case, the sphere $\Sigma$  will be called the 
\index{inversion!sphere of inversion}\emph{sphere of inversion} 
and its center is called \index{inversion!center of inversion}\emph{center of inversion}.

We also add $\infty$ to the space and assume that the center of inversion is mapped to $\infty$ and the other way around. 
The space $\mathbb{R}^3$ with the point $\infty$ will be called \index{inversive space}\emph{inversive space}.

The inversion of the space 
has many properties 
of the inversion of the plane.
Most important for us is the analogs of theorems \ref{lem:inverse-4-angle}, \ref{thm:inverse-cline}, \ref{thm:angle-inversion} which can be summarized as follows.

\begin{thm}{Theorem}\label{thm:inverion-3d}
The inversion in the sphere has the following properties:
\begin{enumerate}[(a)]
\item\label{thm:inverion-3d:a} Inversion maps sphere or plane into sphere or plane.
\item\label{thm:inverion-3d:b} Inversion maps circle or line into circle or line. 
\item\label{thm:inverion-3d:cross-ratio} Inversion preserves cross-ratio; that is, if $A'$, $B'$, $C'$ and $D'$ be the inversions of the points $A$, $B$, $C$ and $D$ correspondingly 
then
$$\frac{AB\cdot CD}{BC\cdot DA}= \frac{A'B'\cdot C'D'}{B'C'\cdot D'A'}.$$
\item Inversion maps arcs into arcs.
\item\label{thm:inverion-3d:angle} Inversion preserves the absolute value of the angle
measure between tangent half-lines to the arcs.
\end{enumerate}
\end{thm}


We do not present the proofs here, but
they nearly repeat the corresponding proofs in plane geometry.
To prove (\ref{thm:inverion-3d:a}), you will need in addition the following lemma;
its proof is left to the reader.

\begin{thm}{Lemma}
Let $\Sigma$ be a subset of Euclidean space
which contains at least two points.
Fix a point $O$ in the space.

Then $\Sigma$ is 
a sphere 
if and only if
for any plane $\Pi$ passing thru $O$,
the intersection $\Pi\cap \Sigma$ is either empty set,
one point set or a circle.
\end{thm}  

The following observation helps to reduce part~(\ref{thm:inverion-3d:b}) to part~(\ref{thm:inverion-3d:a}).

\begin{thm}{Observation}
Any circle in the space can be presented as an intersection of two spheres.
\end{thm}


\section*{Stereographic projection}
\addtocontents{toc}{Stereographic projection.}

Consider the unit sphere $\Sigma$ 
centered at the origin $(0,0,0)$.
This sphere can be described by equation $x^2+y^2+z^2=1$. 

\begin{wrapfigure}{o}{48mm}
\begin{lpic}[t(-3mm),b(-1mm),r(0mm),l(0mm)]{pics/stereographic_projection(1)}
\lbl[rb]{23,24;$O$}
\lbl[l]{38,39;$P$}
\lbl[tl]{24,2;$S$}
\lbl[br]{23,44;$N$}
\lbl[lt]{31,22;$P'$}
\end{lpic}
\caption*{The plane thru\\ $P$, $O$ and $S$.}
\end{wrapfigure}

Denote by $\Pi$ the $xy$-plane;
it is defined by the equation $z = 0$.
Clearly $\Pi$
runs thru the center of $\Sigma$.

Denote by $N = (0, 0, 1)$ the ``North Pole'' and by $S=(0, 0, -1)$ be the ``South Pole'' of $\Sigma$; these are the points on the sphere which have extremal distances to $\Pi$.
Denote by $\Omega$ the ``equator'' of $\Sigma$;
it is the intersection $\Sigma\cap\Pi$.

For any point $P\ne S$ on $\Sigma$,
consider the line $(SP)$ in the space. 
This line intersects $\Pi$ in exactly one point, denoted as $P'$. 
Set $S'=\infty$.


The map $\xi_s\: P\mapsto P'$ is called \index{stereographic projection}\emph{stereographic projection from $\Sigma$ to $\Pi$ from the South Pole}.
The inverse of this map $\xi^{-1}_s\: P'\z\mapsto P$ is called {}\emph{stereographic projection from $\Pi$ to $\Sigma$ from the South Pole}.

In the same way one can define 
{}\emph{stereographic projections $\xi_n$ and $\xi^{-1}_n$ from the North Pole} $N$.

Note that $P=P'$ if and only if $P\in\Omega$.


Note that if $\Sigma$ and $\Pi$ are as above,
then the composition of the stereographic projections 
$\xi_s: \Sigma\to\Pi$ and  $\xi^{-1}_s: \Pi\to\Sigma$ from $S$ 
are the restrictions of the inversion in the sphere with center $S$ and radius $\sqrt{2}$ to $\Sigma$ and $\Pi$ correspondingly.


From above and Theorem~\ref{thm:inverion-3d},
it follows that the stereographic projection preserves 
the angles between arcs;
more precisely {}\emph{the absolute value of the angle measure} between arcs on the sphere.

This makes it particularly useful in cartography.
A map of a big region of earth can not be done in the constant scale,
but using stereographic projection, one can keep the angles between roads the same as on earth.

In the following exercises,
we assume that $\Sigma$, $\Pi$, $\Omega$, $O$, $S$ and $N$ are as above.
  
\begin{thm}{Exercise}\label{ex:two-stereographics}
Show that $\xi_n \circ \xi^{-1}_s$, the composition of stereographic projections 
from $\Pi$ to $\Sigma$ from  $S$, and
from $\Sigma$ to $\Pi$ from  $N$ is 
the inversion of the plane $\Pi$ in $\Omega$.
\end{thm}

\begin{thm}{Exercise}\label{ex:great-circ}
Show that  a stereographic projection $\Sigma\to\Pi$
sends the great circles to circlines on the plane which intersects $\Omega$ at two opposite points.
\end{thm}

\begin{thm}{Exercise}\label{ex:conform-sphere}
Fix a point $P\in \Pi$  and let $Q$ be yet an other point in $\Pi$.
Denote by $P'$ and $Q'$ their stereographic projections to $\Sigma$.
Set $x=PQ$ and $y=P'Q'_s$.
Show that
$$\lim_{x\to 0} \frac{y}{x}=\frac{2}{1+OP^2}.$$

Compare with Lemma~\ref{lem:conformal}.
\end{thm}



\section*{Central projection}
\addtocontents{toc}{Central projection.}

Let $\Sigma$ be the unit sphere centered at the origin which will be denoted as $O$.
Denote by $\Pi^+$ the plane defined by the equation $z=1$.
This plane is parallel to $xy$-plane and it passes thru 
the North Pole $N=(0,0,1)$ of $\Sigma$.

Recall that the northern hemisphere of $\Sigma$,
is the subset of points $(x,y,z)\z\in \Sigma$ such that $z>0$.
The northern  hemisphere will be denoted as $\Sigma^+$.

Given a point $P\in \Sigma^+$, consider the  
half-line $[OP)$ and denote by $P'$ the intersection of $[OP)$ and $\Pi^+$.
Note that if $P=(x,y,z)$ then $P'=(\tfrac xz,\tfrac yz,1)$.
It follows that $P\mapsto P'$ is a bijection between $\Sigma^+$ and $\Pi^+$.

The described map $\Sigma^+\to \Pi^+$ is called \index{central projection}\emph{central projection} of 
the hemisphere $\Sigma^+$.

In spherical geometry,
central projection is analogous to
the projective model of hyperbolic plane which is discussed in Chapter~\ref{chap:klein}.

Note that the central projection sends intersections of great circles with $\Sigma^+$ to the lines in $\Pi^+$.
The latter follows since great circles are formed by intersection of $\Sigma$ with planes passing thru the origin and the lines in  $\Pi^+$ are formed by intersection of $\Pi^+$ with these planes.

\begin{thm}{Exercise}\label{ex:pyth-s}
Assume that $N$ is the North Pole and $\triangle_s NBC$ has right angle at $C$ and  lies completely in the north hemisphere.
Let $\triangle NB'C'$ be the image of $\triangle_s NBC$ under central projection.

Observe that $\triangle NB'C'$ has right angle at $C'$.

Set 
\begin{align*}
 a&=BC_s, &b&=CN_s, &c&=NB_s,\\
 s&=B'C',&t&=C'N,&u&=NB'.
\intertext{Show that}
s&=\tfrac{\tan a}{\cos b},
&
t&=\tan b,
&
u&=\tan c.
\end{align*}

Use these identities together with the Euclidean Pythagorean theorem
\[u^2=s^2+t^2\]
for $\triangle NB'C'$ to prove spherical Pythagorean theorem 
\[\cos c=\cos a\cdot\cos b\]
for $\triangle_s NBC$.
\end{thm}

The following exercise 
is analogous to Exercise~\ref{ex:h-median}
in hyperbolic geometry.

\begin{thm}{Exercise}\label{ex:s-medians}
Let $\triangle_sABC$ be a nondegenerate spherical triangle.
Assume that the plane $\Pi^+$ is parallel to the plane passing thru $A$, $B$ and $C$.
Denote by $A'$, $B'$ and $C'$ the central projections of $A$, $B$ and $C$.
\begin{enumerate}[(a)]
\item\label{ex:s-medians:a} Show that the midpoints of $[A'B']$, $[B'C']$ and $[C'A']$
are central projections of the midpoints of $[AB]_s$, $[BC]_s$ and $[CA]_s$ correspondingly.
\item\label{ex:s-medians:b} Use part (\ref{ex:s-medians:a}) to show that medians of spherical triangle intersect at one point.
\end{enumerate}

\end{thm}





\addtocontents{toc}{\protect\end{quote}}