%\part*{Additional topics}
\addtocontents{toc}{\protect\contentsline{part}{\protect\numberline{}Additional topics}{}{}}

\chapter{Affine geometry}\label{chap:trans}

\section{Affine transformations}

\emph{Affine geometry} studies the so-called \index{incidence structure}\emph{incidence structure} of the Euclidean plane.
The incidence structure sees only which points lie on which lines and nothing else;
it does not directly see distances, angle measures, and many other things.

A bijection from the Euclidean plane to itself is called an \index{affine transformation}\emph{affine transformation} if it maps lines to lines;
that is, the image of any line is a line.
So, one can say that affine geometry studies the properties of the Euclidean plane that are preserved under affine transformations.

\begin{thm}[!]{Classroom exercise}\label{ex:affine-par}
Show that an affine transformation of the Euclidean plane sends every pair of parallel lines to a pair of parallel lines.
\end{thm}

The observation below follows because lines are defined using only the metric.

\begin{thm}{Observation}
Any motion of the Euclidean plane is an affine transformation.
\end{thm}

The following exercise provides more general examples of affine transformations.

\begin{thm}[!]{Exercise}\label{ex:afine-linear}
Show that the following maps of a coordinate plane to itself define affine transformations:
\begin{enumerate}[(a)]
\item\label{ex:afine-linear:shear} \index{shear map}\emph{Shear map} defined by $(x,y)\mapsto (x+k\cdot y,y)$ for a constant~$k$.
\item\label{ex:afine-linear:scaling}
Rescaling defined by $(x,y)\mapsto (a\cdot x,a\cdot y)$ for a constant $a\ne 0$.
\item $x$-scaling and $y$-scaling defined respectively by 
\[(x,y)\mapsto (a\cdot x,y),\quad\text{and}\quad(x,y)\mapsto (x,a\cdot y)\]
for a constant $a\ne 0$.
\item\label{affine-general-formula} A transformation defined by
\[(x,y)\mapsto(a\cdot x+b\cdot y+r,c\cdot x+d\cdot y+s)\]
for constants $a,b,c,d,r,s$ such that the matrix $(\begin{smallmatrix}a&b\\c&d\end{smallmatrix})$ is invertible. 
\end{enumerate}
\end{thm}

From the fundamental theorem of affine geometry (\ref{thm:fundamental-theorem-of-affine-geometry}), it will follow that any affine transformation can be written in the form \textit{(\ref{affine-general-formula})}.

Recall that points are \index{collinear}\emph{collinear} if they lie on a single line.

\begin{thm}{Exercise}\label{ex:collinear=affine}
Suppose $P\mapsto P'$ is a bijection of the Euclidean plane that maps collinear triples of points to collinear triples.
Show that $P\mapsto P'$ maps noncollinear triples to noncollinear ones.

Conclude that $P\mapsto P'$ is an affine transformation.
\end{thm}

\begin{thm}{Exercise}\label{ex:circle=affine}
Let $\alpha$ be a bijection of the Euclidean plane that maps every circle to a circle.
Show that $\alpha$ is an affine transformation.
\end{thm}

\section{Constructions}

\begin{wrapfigure}{r}{34mm}
\vskip-15mm
\centering
\includegraphics{mppics/pic-287}
\end{wrapfigure}

Let us consider geometric constructions with a ruler and a \index{parallel!tool}\emph{parallel tool};
the latter allows us to draw a line thru a given point parallel to a given line.
(One may think of the tool in the figure.
It consists of two straight edges joined by two arms that can move while remaining parallel to each other.)

By Exercise~\ref{ex:affine-par}, any construction with these two tools is invariant with respect to affine transformations.
For example, 
to solve the following exercise,
it is sufficient to prove that the midpoint of a given segment can be constructed with a ruler and a parallel tool.

\begin{thm}{Exercise}\label{ex:midpoint-affine}
Let $M$ be the  midpoint of a segment $[AB]$ in the Euclidean plane.
Assume that an affine transformation sends the points $A$, $B$, and $M$
to $A'$, $B'$, and $M'$ respectively.
Show that $M'$ is the midpoint of~$[A'B']$.
\end{thm}

The following exercise will be used in the proof of Proposition~\ref{prop:affine-linear}.

\begin{thm}[!]{Exercise}\label{ex:R-hom}
Assume that points with coordinates $(0,0)$, $(1,0)$, $(a,0)$, and $(b,0)$ are given.
Using a ruler and a parallel tool, construct points with coordinates $(a+b,0)$, $(a-b,0)$, $(a\cdot b,0)$, and $(\tfrac a b,0)$.
\end{thm}

\begin{thm}{Exercise}\label{ex:center-circ-affine}
Construct the center of a given circle using the ruler and the parallel tool.
\end{thm}

The shear map (described in \ref{ex:afine-linear}\textit{\ref{ex:afine-linear:shear}}) can change angles between lines almost arbitrarily.
This observation can be used to prove the impossibility of some constructions;
here is one example:

\begin{thm}{Exercise}\label{ex:affine-perp}
Show that one cannot construct a line perpendicular to a given line with the ruler and the parallel tool.
\end{thm}

\section{Fundamental theorem of affine geometry}

In this section, we assume knowledge of vector algebra; namely, multiplication by a real number, addition, and the parallelogram rule.

\begin{thm}[!]{Exercise}\label{ex:parallelogram-rule}
Show that affine transformations map parallelograms to parallelograms.
Conclude that if $P\mapsto P'$ is an affine transformation, then
\[\overrightarrow{XY}=\overrightarrow{AB},
\quad\text{if and only if}\quad
\overrightarrow{X'Y'}=\overrightarrow{A'B'}.\]

\end{thm}


\begin{thm}{Proposition}\label{prop:affine-linear}
Let $P\mapsto P'$ be an affine transformation of the Euclidean plane.
Then, for every triple of points $O$, $X$, $P$, we have
\[\overrightarrow{OP}=t\cdot \overrightarrow{OX}
\quad\text{if and only if}\quad
\overrightarrow{O'P'}=t\cdot \overrightarrow{O'X'}.
\eqlbl{eq:OP=tOX}\]

\end{thm}

\parit{Proof.}
Observe that the affine transformations described in Exercise~\ref{ex:afine-linear}, as well as all motions, satisfy the condition \ref{eq:OP=tOX}.
Therefore a given affine transformation $P\mapsto P'$ satisfies \ref{eq:OP=tOX} if and only if its composition with motions and rescalings satisfies \ref{eq:OP=tOX}.

Applying this observation, we can reduce the problem to a special case.
Namely, we may assume that $O'=O$, $X'=X$, the point $O$ is the origin of a coordinate system, and $X$ has coordinates $(1,0)$.

In this case, $\overrightarrow{OP}=t\cdot \overrightarrow{OX}$ if and only if $P=(t,0)$.
Since $O$ and $X$ are fixed, the transformation maps the $x$-axis to itself.
That is, $P'=(f(t),0)$ for a function $t\mapsto f(t)$,
or, equivalently,
\[\overrightarrow{O'P'}=f(t)\cdot \overrightarrow{O'X'}.\]

Since $O'=O$ and $X'=X$, we get $f(0)=0$ and $f(1)=1$.
Furthermore, according to Exercise~\ref{ex:R-hom}, we have
$f(x\cdot y)=f(x)\cdot f(y)$ and $f(x+y)=f(x)+f(y)$ for any $x,y\in\mathbb{R}$.
By the algebraic lemma (proved below, see \ref{lem:R-auto}), these conditions imply that $f(t)=t$ for any~$t$, which completes the proof.
\qeds

\begin{thm}{Fundamental theorem of affine geometry}\label{thm:fundamental-theorem-of-affine-geometry}\index{Fundamental theorem of affine geometry}
Suppose that an affine transformation $P\mapsto P'$ maps a nondegenerate triangle $OXY$ to a triangle $O'X'Y'$.
Then $\triangle O'X'Y'$ is nondegenerate, and
\[\overrightarrow{OP}=x\cdot\overrightarrow{OX}+y\cdot\overrightarrow{OY}\quad\text{if and only if}\quad\overrightarrow{O'P'}=x\cdot\overrightarrow{O'X'}+y\cdot\overrightarrow{O'Y'}.\]
\end{thm}

\parit{Proof.}
Since an affine transformation maps lines to lines, the triangle
$O'X'Y'$ is nondegenerate.

Consider points $V$ and $W$ defined by
\[\overrightarrow{OV}=x\cdot\overrightarrow{OX},
\qquad
\overrightarrow{OW}=y\cdot\overrightarrow{OY}.
\]

{

\begin{wrapfigure}{o}{33mm}
\centering
\vskip-0mm
\includegraphics{mppics/pic-225}
\end{wrapfigure}

Note that 
$\overrightarrow{WP}=\overrightarrow{OV}$.
Applying Exercise~\ref{ex:parallelogram-rule} and the proposition, we get
\begin{align*}\overrightarrow{O'P'}&=\overrightarrow{O'W'}+\overrightarrow{W'P'}=
\\
&=\overrightarrow{O'W'}+\overrightarrow{O'V'}=
\\
&=x\cdot\overrightarrow{O'X'}+y\cdot\overrightarrow{O'Y'}.
\end{align*}
\qedsf

}

\begin{thm}{Exercise}\label{ex:affine-continuous}
Show that every affine transformation is continuous.
\end{thm}

The following exercise provides the converse to Exercise \ref{ex:afine-linear}\textit{\ref{affine-general-formula}}.

\begin{thm}{Exercise}\label{ex:affine-coordinates}
Show that every affine transformation can be written in coordinates as
$(x,y)\mapsto(a\cdot x+b\cdot y+r,\ c\cdot x+d\cdot y+s)$
for constants $a,b,c,d,r,s$ such that the matrix $(\begin{smallmatrix}a&b\\c&d\end{smallmatrix})$ is invertible. 
\end{thm}

\begin{thm}{Exercise}\label{ex:preserved-circle}
Let $\Gamma$ be a circle with center $O$.
Suppose $\alpha\:P\mapsto P'$ is an affine transformation that maps $\Gamma$ to itself.
Show that $\alpha$ is a motion that fixes $O$;
that is, $O'=O$.
\end{thm}

A bijection from the inversive plane to itself is called an \index{inversive!transformation}\emph{inversive transformation} if it maps circlines to circlines.
By \ref{thm:inverse-cline},  inversions are  inversive transformations.

\begin{thm}{Advanced exercise}\label{ex:inversions-inversive}
Show that every inversive transformation is a composition of inversions and reflections.
\end{thm}



\section{An algebraic lemma}

The following lemma was used in the proof of Proposition~\ref{prop:affine-linear}.

\begin{thm}{Lemma}\label{lem:R-auto}
Assume $f\:\mathbb{R}\to\mathbb{R}$ is a function such that for any $x,y\in\mathbb{R}$ we have
\begin{enumerate}[(a)]
\item\label{lem:R-auto:a} $f(1)=1$,
\item\label{lem:R-auto:b} $f(x+y)=f(x)+f(y)$,
\item\label{lem:R-auto:c} $f(x\cdot y)=f(x)\cdot f(y)$.
\end{enumerate}

Then $f$ is the identity function; that is,
$f(x)=x$ for any $x\in \mathbb{R}$.
\end{thm}

Note that we did not assume that $f$ is continuous.

A function $f$ satisfying these three conditions
is called a \index{field automorphism}\emph{field automorphism}.
Therefore, the lemma states that the identity function is the only automorphism of the field of real numbers.
For the field of complex numbers, the conjugation $z\mapsto\bar z$ (see Section~\ref{sec:complex-conjugation}) gives an example of a nontrivial automorphism.

\begin{thm}{Exercise}\label{ex:f(1)=1}
Suppose that $f\:\mathbb{R}\to\mathbb{R}$ satisfies the condition (\ref{lem:R-auto:c}) in the lemma.
Show that 
\begin{enumerate}[(i)]
 \item if $f(1)\ne 1$, then $f(x)=0$ for any $x$;
  \item if $f(0)\ne 0$, then $f(x)=1$ for any $x$.
\end{enumerate}
\end{thm}


\parit{Proof of \ref{lem:R-auto}.}
By \textit{(\ref{lem:R-auto:b})} we have
$f(0)+f(0)=f(0+0)=f(0)$.
Therefore,
\[f(0)=0.
\eqlbl{eq:0=0}\]

Applying \textit{(\ref{lem:R-auto:b})} again, we get that $0=f(0)=f(x)+f(-x)$.
Therefore, 
\[f(-x)=-f(x)
\quad
\text{for any}
\quad
x\in \mathbb{R}.
\eqlbl{eq:f-x}\] 

Applying \textit{(\ref{lem:R-auto:a})} and \textit{(\ref{lem:R-auto:b})} recursively, we get that
\begin{align*}
f(2)&=f(1)+f(1)=1+1=2;\\
f(3)&=f(2)+f(1)=2+1=3;\\
&\dots
\end{align*}
Together with \ref{eq:f-x},
the latter implies that 
$f(n)=n$
for every integer
$n$. 
By~\textit{(\ref{lem:R-auto:c})},
$f(m)=f(\tfrac mn)\cdot f(n)$.
Therefore
$$f(\tfrac mn)=\tfrac mn \eqlbl{eq:m/n}$$
for every rational number~$\tfrac mn$.

Assume~$a\ge 0$.
Then the equation $x^2=a$ has a real solution $x\z=\sqrt{a}$.
Suppose $y=f(x)$.
By~\textit{(\ref{lem:R-auto:c})}, $f(a)=y^2$,
and hence $f(a)\ge 0$.

\raggedcolumns\setlength{\multicolsep}{.5mm}
\setlength{\columnseprule}{1pt}
\begin{multicols}{2}
In particular,
\[a\ge 0\quad\Longrightarrow\quad f(a)\ge 0.\eqlbl{a>0=>b>0}\]

\columnbreak

By \ref{eq:f-x}, 
we also get 
\[a\le 0\quad \Longrightarrow\quad f(a)\le 0.\eqlbl{a<0=>b<0}\]
\end{multicols}
\setlength{\columnseprule}{0pt}

Now assume $f(a)\ne a$ for some $a\in\mathbb{R}$.
Then there is a rational number $\tfrac{m}{n}$ that lies between $a$ and $f(a)$;
that is, 
the numbers 
\[x\z=a-\tfrac{m}{n}\quad\text{and}\quad y=f(a)-\tfrac{m}{n}\]
have opposite signs.

By \ref{eq:m/n},
\begin{align*}
y+\tfrac{m}{n}&=f(a)=
\\
&=f(x+\tfrac{m}{n})=
\\
&=f(x)+f(\tfrac{m}{n})=
\\
&=f(x)+\tfrac{m}{n};
\end{align*}
that is, $f(x)=y$.
By \ref{a>0=>b>0} and \ref{a<0=>b<0} the values $x$ and $y$ cannot have opposite signs --- a contradiction.
\qeds

\section{Three theorems}

We discussed several statements in Euclidean geometry that have an affine nature;
that is, their assumptions and conclusions survive under affine transformations.
The examples include 
\ref{thm:parallel-point-reflection},
\ref{lem:parallelogram}\ref{lem:parallelogram:midpoint},
\ref{ex:4parallels},
\ref{thm:centroid},
and \ref{ex:midle}.
In this section, we present three more examples of that type.

Suppose that $A$, $B$, and $X$ are distinct points on one line.
Note that 
\[\overrightarrow{AX}=t\cdot \overrightarrow{BX},\]
where $t=\pm\frac{AX}{BX}$.

Choose an affine transformation $P\mapsto P'$.
By \ref{prop:affine-linear}, we have 
\[\overrightarrow{A'X'}=t\cdot \overrightarrow{B'X'}.\]
It follows that $\frac{A'X'}{B'X'}=\frac{AX}{BX}$;
that is, \textit{if $A$, $B$, and $X$ are distinct points on one line, then the ratio $\frac{AX}{BX}$ is preserved under affine transformations}.

\begin{thm}{Menelaus's theorem}\index{Menelaus's theorem}
Let $ABC$ be a nondegenerate triangle.
Suppose a line $\ell$ crosses the lines $(BC)$, $(CA)$, and $(AB)$ at three distinct points $A'$, $B'$, and $C'$.
Then 
\[\frac{AC'}{BC'}\cdot\frac{BA'}{CA'}\cdot \frac{CB'}{AB'}=1.\]
\end{thm}

As we saw, the ratios $\frac{AC'}{BC'}$, $\frac{BA'}{CA'}$, $\frac{CB'}{AB'}$ are preserved under affine transformations.
Therefore Menelaus's theorem belongs to affine geometry.
However, in the proof we can (and will) use Euclidean-type arguments.

\parit{Proof.}
Let $X$, $Y$ and $Z$ be the footpoints of $A$, $B$ and $C$ on $\ell$.
By the AA similarity condition, $\triangle AXC'\sim \triangle BYC'$.
\begin{figure}[!ht]
\centering
\includegraphics{mppics/pic-227}
\vskip-10mm
\end{figure}
Therefore, 
\[\frac{AC'}{BC'}=\frac{AX}{BY}.\]
The same way we get
\[\frac{BA'}{CA'}=\frac{BY}{CZ}
\quad\text{and}\quad
\frac{CB'}{AB'}=\frac{CZ}{AX}.\]
Therefore,
\[\frac{AC'}{BC'}\cdot\frac{BA'}{CA'}\cdot \frac{CB'}{AB'}=\frac{AX}{BY}\cdot \frac{BY}{CZ}\cdot \frac{CZ}{AX}=1.\]
\qedsf


{

\begin{thm}{Exercise}\label{thm:ceva-affine}\label{ex:ceva-affine}
Let $ABC$ be a nondegenerate triangle.
Suppose three distinct points $A'$, $B'$, and $C'$ lie on the lines $(BC)$, $(CA)$, and $(AB)$ respectively.
Assume that the lines $(AA')$, $(BB')$ and $(CC')$ meet at a point $X$.

\begin{wrapfigure}{r}{31mm}
\centering
\vskip-2mm
\includegraphics{mppics/pic-229}
\end{wrapfigure}

Use Menelaus's theorem to prove the following.

\begin{enumerate}[(a)]
\item \index{Ceva's theorem}\textbf{Ceva's theorem:}
\[\frac{AC'}{BC'}\cdot\frac{BA'}{CA'}\cdot \frac{CB'}{AB'}=1.\]
\item \index{Van Aubel's theorem}\textbf{Van Aubel's theorem:} If $A'$ lies between $B$ and $C$, then
\[\frac{AC'}{BC'}+\frac{AB'}{CB'}=\frac{AX}{A'X}.\]
\end{enumerate}
\end{thm}

}

\parbf{Signed versions.}
These three theorems can be formulated in a more precise way by taking the ratios $\frac{AC'}{BC'}$, $\frac{BA'}{CA'}$, and $\frac{CB'}{AB'}$ with sign.
Namely, given distinct points $A$, $B$, and $X$ on a line, let us define the \index{signed ratio}\emph{signed ratio} $(\frac{AX}{BX})\df\pm\frac{AX}{BX}$, where the sign is chosen so that
$\overrightarrow{AX}=\left(\frac{AX}{BX}\right)\cdot \overrightarrow{BX}$.
Equivalently, $(\frac{AX}{BX})<0$ if and only if $X$ lies between $A$ and $B$.

The more exact identities of Menelaus's and Ceva's theorems will be
\[\left(\tfrac{AC'}{BC'}\right)\cdot\left(\tfrac{BA'}{CA'}\right)\cdot \left(\tfrac{CB'}{AB'}\right)=1
\quad\text{and}\quad
\left(\tfrac{AC'}{BC'}\right)\cdot\left(\tfrac{BA'}{CA'}\right)\cdot \left(\tfrac{CB'}{AB'}\right)=-1
\]
respectively.
In Van Aubel's theorem we have
\[\left(\tfrac{AC'}{BC'}\right)+\left(\tfrac{AB'}{CB'}\right)=\left(\tfrac{AX}{A'X}\right)\]
and this identity holds without the assumption that $A'$ lies between $B$ and~$C$.

Moreover, the converse of each of the three signed versions also holds.

